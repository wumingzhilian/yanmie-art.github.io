## 搞吧骚年！！！ 					

查看 `robots.txt` ，

```
User-agent: *
Disallow:index.txt
```

得到 `index.txt` ,查看得到后端源码：

```php

<?php

include 'flag.php';

$yy = "d";
$i = "c";
$bb = 'yy';

foreach($_POST as $x => $y){
    $$x = $y;
}

foreach($_GET as $x => $y){
    $$x = $$y;
}

foreach($_GET as $x => $y){
    if($_GET['flag'] === $x && $x !== 'flag'){
        exit($bb);
    }
}

if(!isset($_GET['flag']) && !isset($_POST['flag'])){
    exit($yy);
}

if($_POST['flag'] === 'flag'  || $_GET['flag'] === 'flag'){
    exit($i);
}



echo "the flag is: ".$flag;
```

变量覆盖，

![0y4dJI.png](https://s1.ax1x.com/2020/10/10/0y4dJI.png)

在页面底部出现d 是为什么呢？

程序执行的时候，执行到了箭头所指，就退出了,随之显示`$yy`的值。

![0y5J10.png](https://s1.ax1x.com/2020/10/10/0y5J10.png)

那么我们想着如果把flag的值赋给 $yy ,那不就输出 flag 了吗。

正好可以用到变量覆盖达成目的。

```php
foreach($_GET as $x => $y){
    $$x = $$y;     // 这里传入 yy=flag ,变量覆盖至后就变成了 $yy=$flag.
}
```

传参` http://62.234.56.138:8105/?yy=flag` 直接得到 flag.

当然相同的道理这样也可以： `http://62.234.56.138:8105/?flag=flag&i=flag`



## decode_me

下载附件，得到

```php
<?php
$miwen="a1zLbk3p0A3rmE2nt5Jn6gas";

function encode($str){
    $_o=strrev($str);
    // echo $_o;
        
    for($_0=0;$_0<strlen($_o);$_0++){
       
        $_c=substr($_o,$_0,1);
        $__=ord($_c)+1;
        $_c=chr($__);
        $_=$_.$_c;   
    } 
    return str_rot13(strrev(base64_encode($_)));
}

highlight_file(__FILE__);
/*
   逆向加密算法，解密$miwen就是flag
*/
?>
```

这里需要逆向写个解密脚本。

为了防止那些花里胡哨的变量名闪了眼，这里利用记事本统一替换，顺便加上解释。

```php
<?php
$miwen="a1zLbk3p0A3rmE2nt5Jn6gas";

function encode($str){
    $str=strrev($str);
    // echo $str;
        
    for($i=0;$i<strlen($str);$i++){
       
        $_c=substr($str,$i,1);   // 截取每位字符串
        $__=ord($_c)+1;          // 转换为 ascii + 1
        $_c=chr($__);            //  转换为 字符
        $_=$_.$_c;               //  拼接新字符串
    } 
    return str_rot13(strrev(base64_encode($_)));
}

highlight_file(__FILE__);
/*
   逆向加密算法，解密$miwen就是flag
*/
?>
```

那么就可以反过来写脚本了。

```php
<?php

$miwen="a1zLbk3p0A3rmE2nt5Jn6gas";

$str = base64_decode(strrev(str_rot13($miwen)));

// echo $str;

for($i=0;$i<strlen($str);$i++){
       
        $_c=substr($str,$i,1);   
        $__=ord($_c)-1;         
        $_c=chr($__);            
        $_=$_.$_c;           
    } 
	
	$str = strrev($_);
	echo $str;
```



ok。